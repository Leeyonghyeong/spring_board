<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security"
             xmlns:beans="http://www.springframework.org/schema/beans"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://www.springframework.org/schema/beans
                                 http://www.springframework.org/schema/beans/spring-beans.xsd
                                 http://www.springframework.org/schema/security
                                 http://www.springframework.org/schema/security/spring-security.xsd">
        
        
	<http auto-config="true" use-expressions="true">
		<!-- csrf 설정 -->
		<csrf disabled="false"></csrf>
		
		<!-- 페이지 권한 설정 -->
	    <intercept-url pattern="/delete" access="hasAnyRole('ROLE_USER', 'ROLE_MEMBER', 'ROLE_ADMIN')"/>
	    <intercept-url pattern="/register/**" access="hasAnyRole('ROLE_USER', 'ROLE_MEMBER', 'ROLE_ADMIN')" />
	    <intercept-url pattern="/update/**" access="hasAnyRole('ROLE_USER', 'ROLE_MEMBER', 'ROLE_ADMIN')" />
	    <intercept-url pattern="/**" access="permitAll" />
	    
	    <!-- login페이지 custom -->
	    <form-login
	    	username-parameter="userid"
	    	password-parameter="userpw"
	    	login-processing-url="/login"
	    	login-page="/login"
	    	default-target-url="/"
	    />
	    
	    <!-- 403페이지 custom -->
	    <!-- <access-denied-handler
	    	error-page="/denied_page"
	    />-->
	    
	    <!-- cors 설정(servlet-context.xml 에 cors 설정해야함 -->
	    <cors />
	    
	</http>
	
	<authentication-manager>
	    <authentication-provider>
	        <user-service>
	            <user name="user" password="userPw" authorities="ROLE_USER"/>
	            <user name="guest" password="guest" authorities="ROLE_GUEST"/>
	        </user-service>
	    </authentication-provider>
	</authentication-manager>
    
</beans:beans>